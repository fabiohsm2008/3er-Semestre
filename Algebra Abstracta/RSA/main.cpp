#include <iostream>
#include <fstream>
#include "RSA.h"

using namespace std;

int main()
{
    srand(time(NULL));
    ifstream ficheroEntrada;
    string mensaje;
    ficheroEntrada.open ("mensaje.txt",ios::out | ios::binary);
    getline(ficheroEntrada,mensaje);
    ficheroEntrada.close();
    RSA receptor(512);
    ///RSA emisor(receptor.get_e(),receptor.get_N());
    receptor.set_p(stringTozz("3033058104364587777301649224066897044718090035752557577767398758792886556930683886193244742111168716653924518888657886953597137928269798608302231140213563"));
    receptor.set_q(stringTozz("4188713856051730030527755468732128652892657612091528510567075289127877040647398483149583955062017268185485049450755069837852340285466158570551245997116211"));
    receptor.set_N(stringTozz("12704612507961943086842896654718822564677087686870197202866602945676607648494097770191167054247409630628135937630554348358903604149787668658632748316499772747443217408471532150706497728240923389584850841527273183997906274087347642364408391123066501147989268155114436843598969059021816470965792911892669369793"));
    receptor.set_d(stringTozz("9579092735594065042440248953489491536725833054437595393850010325216306883705704145646391209859049300496710610141763542657686445587787881618458328499391823485548433867670732771451226676926161722729812024123092097424931370703212206698077803474839390366294606866702006984378464151398262646617482889101900572957"));
    receptor.set_e(stringTozz("7290591002354201134542048342668614155459233566391948999274795462109710373033395681693177400726006941291323090264250874810823406740288058770373617511217273"));
    ZZ e, N;
    /*Cristhian
    e = stringTozz("8050189495819646230367274162312647113687626492793618413811586219413549346409258142644748710444378881002845334635603379236368509428785940922547000358874607");
    N = stringTozz("32541992493192865024404949100205090074774547028968420336938354508114503087301882130019975844009324892080271630066696753285827484808839015255783666113103060446639218367506960291517013790938792999283818593504523408179377470255102546421314864037841412187291154764655718889340996262811672588268220788382494232829");
    */
    e = stringTozz("847931747795025561433118694476312966682478466976315171745935912499032002214218435363736932962694980368449618702816589701094630803961929858408778779876503");
    N = stringTozz("9865733220820695379067867300514756680758517576582715855514687506342106898605267636830911128198093792104075012206382119677659071798268788652185233764509529500868485003345996000592740473461128068091895692930036833721786804497438900259704287969522223783180490697526236602083416115127423371484368566275639092357");
    RSA emisor(e, N);
    ///string cifrado = emisor.cifrar(mensaje);
    ///cout << cifrado << endl;

    string original = receptor.descifrar(mensaje);
    cout << original << endl;
    ofstream ficherosalida;
    ficherosalida.open ("ofset.txt");
    ficherosalida << original;
    ///ficherosalida << cifrado;
    ficherosalida.close();
    return 0;
}
