#include <iostream>
#include <fstream>
#include "RSA.h"

using namespace std;

int main()
{
    srand(time(NULL));
    ifstream ficheroEntrada;
    string mensaje;
    ficheroEntrada.open ("temp.txt",ios::out | ios::binary);
    getline(ficheroEntrada,mensaje);
    ficheroEntrada.close();
    RSA receptor(512);
    ///RSA emisor(receptor.get_e(),receptor.get_N());
    receptor.set_p(stringTozz("3033058104364587777301649224066897044718090035752557577767398758792886556930683886193244742111168716653924518888657886953597137928269798608302231140213563"));
    receptor.set_q(stringTozz("4188713856051730030527755468732128652892657612091528510567075289127877040647398483149583955062017268185485049450755069837852340285466158570551245997116211"));
    receptor.set_N(stringTozz("12704612507961943086842896654718822564677087686870197202866602945676607648494097770191167054247409630628135937630554348358903604149787668658632748316499772747443217408471532150706497728240923389584850841527273183997906274087347642364408391123066501147989268155114436843598969059021816470965792911892669369793"));
    receptor.set_d(stringTozz("9579092735594065042440248953489491536725833054437595393850010325216306883705704145646391209859049300496710610141763542657686445587787881618458328499391823485548433867670732771451226676926161722729812024123092097424931370703212206698077803474839390366294606866702006984378464151398262646617482889101900572957"));
    receptor.set_e(stringTozz("7290591002354201134542048342668614155459233566391948999274795462109710373033395681693177400726006941291323090264250874810823406740288058770373617511217273"));
    ZZ e;
    e = 4748895241158472806747778378885960298737010707545752780521734390797404657290727281698976201991978032627900087302518364964065988394241395298318491165979819;
    ZZ N;
    N = 6472249208533067672468696653479774004234251310580742082201160146770217611147509533543245559696187431284268035487088183252659624864661087026227435706758947;
    RSA emisor(e, N);
    string cifrado = emisor.cifrar(mensaje);
    ///string original = receptor.descifrar(mensaje);
    cout << cifrado << endl;
    ///cout << original << endl;
    ofstream ficherosalida;
    ficherosalida.open ("mensaje.txt");
    ///ficherosalida << original;
    ficherosalida << cifrado;
    ficherosalida.close();
    return 0;
}
